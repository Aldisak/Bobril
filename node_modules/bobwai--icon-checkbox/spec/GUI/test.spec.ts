import { BBBot, BBSeeker } from "bbseeker-extended";
import { createLayout } from "./layout";
import { clearTestStore, getTestStore } from "./store";
import { Selectors } from "../../src/testSelectors";

describe("IconCheckbox UI tests", () => {
    afterEach(() => {
        BBBot.clear();
        clearTestStore();
    });

    it("should be possible to click on checkbox and change the value", async () => {
        createLayout();
        const bot = BBBot.createBot();
        if (await BBBot.checkIfFullyRendered(4)) {
            const checkbox = BBSeeker.findElement(Selectors.id);
            expect(checkbox).not.toBeNull();

            const clickableElement = BBSeeker.findElement(Selectors.id + Selectors.clickableElement);
            expect(clickableElement).not.toBeNull();

            expect(getTestStore().value).toBe(false);
            await bot.emitLeftMouseClickOnHTMLElement(clickableElement!);
            expect(getTestStore().value).toBe(true);
            await bot.emitLeftMouseClickOnHTMLElement(clickableElement!);
            expect(getTestStore().value).toBe(false);
            await bot.emitKeyPress(BBBot.KeyCodes.Spacebar);
            expect(getTestStore().value).toBe(true);
            await bot.emitKeyPress(BBBot.KeyCodes.Spacebar);
            expect(getTestStore().value).toBe(false);
        } else {
            fail("Test failed due to it is not fully rendered");
        }
    });
});
