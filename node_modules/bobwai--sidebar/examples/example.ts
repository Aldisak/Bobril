import * as b from "bobril";
import * as Sidebar from "../src/lib";
import * as Container from "bobwai--viewer-container";
import * as Example from "bobwai--example";
import * as SidebarItem from "bobwai--sidebar-item";
import * as SidebarItemCollapsible from "bobwai--sidebar-item-collapsible";

const sampleContent = b.styledDiv("Some content", b.styleDef({ background: "lime" }));

const onClickSimple = (item: SidebarItem.IData): boolean => {
    setActiveItem(subitems, "-1");
    setActiveItem(itemsSimple, item.id);
    b.invalidate();
    return true;
};

const onClickCollapsible = (item: SidebarItem.IData): boolean => {
    item.isExpanded = !item.isExpanded;
    b.invalidate();
    return true;
};

const onClickSubitem = (item: SidebarItem.IData): boolean => {
    setActiveItem(itemsSimple, "-1");
    setActiveItem(subitems, item.id);
    b.invalidate();
    return true;
};

const itemsSimple: SidebarItem.IData[] = [
    { id: "1", title: "Item 1", onClick: onClickSimple },
    { id: "2", title: "Item 2", onClick: onClickSimple },
    { id: "3", title: "Item 3", onClick: onClickSimple },
];

const subitems: SidebarItem.IData[] = [
    {
        id: "4",
        title:
            "Subitem 4Subitem 4Subitem 4Subitem 4Subitem 4Subitem 4Subitem 4Subitem 4Subitem 4Subitem 4Subitem 4Subitem 4Subitem 4Subitem 4Subitem 4Subitem 4Subitem 4Subitem 4Subitem 4Subitem 4Subitem 4Subitem 4Subitem 4Subitem 4Subitem 4",
        onClick: onClickSubitem,
        size: SidebarItem.size.Small,
        isSubitem: true,
    },
    { id: "5", title: "Subitem 5", onClick: onClickSubitem, size: SidebarItem.size.Small, isSubitem: true },
];

const collapsibleItems: SidebarItemCollapsible.IData[] = [
    {
        id: "collapsible 1",
        title: "Collapsible Item 1",
        onClick: onClickCollapsible,
        collapsibleContent: [SidebarItem.create(subitems[0]), SidebarItem.create(subitems[1])],
    },
];

function setActiveItem(source: SidebarItem.IData[], id: string): void {
    source.forEach((item: SidebarItem.IData) => {
        item.isActive = item.id === id;
    });
}

Example.init({}, () => {
    return [
        Container.create({
            header: "SidebarItem complex example",
            content: b.styledDiv("See bobwai--composition--sidebar for complex example of typical usage", { color: "red" }),
        }),
        Container.create({
            header: "Sidebar (basic sample)",
            content: Sidebar.create({}, sampleContent),
        }),
        Container.create({
            header: "Sidebar with items",
            content: Sidebar.create({}, [
                SidebarItem.create(itemsSimple[0]),
                SidebarItem.create(itemsSimple[1]),
                SidebarItem.create(itemsSimple[2]),
                SidebarItemCollapsible.create(collapsibleItems[0]),
            ]),
        }),
    ];
});
