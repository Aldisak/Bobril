import * as b from "bobril";
import { ConsumeFormContext } from "./publicConstants";
import { FormContext, FormVariant } from "./lib";

interface IData {
    size?: number;
}

interface IContext extends b.IBobrilCtx {
    data: IData;
    size?: number;
}

export function tryToSetSizeAccordingFormContext(params: { ctx: IContext; reducedVariantEnumValue: number }): void {
    if (params.ctx.data.size === undefined && ConsumeFormContext()) {
        const formContext = b.useContext(FormContext);
        if (formContext?.formSettings?.variant) {
            params.ctx.size = formContext.formSettings.variant === FormVariant.Reduced ? params.reducedVariantEnumValue : undefined;
        } else {
            params.ctx.size = undefined;
        }
    }
}
