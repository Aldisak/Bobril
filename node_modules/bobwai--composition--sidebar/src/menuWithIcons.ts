import * as b from "bobril";
import * as SidebarItem from "bobwai--sidebar-item";
import * as SidebarItemCollapsible from "bobwai--sidebar-item-collapsible";
import * as dataHelper from "../src/dataHelper";

export function getItems(): b.IBobrilNode[] {
    return dataHelper.getItemsFromData(rootData);
}

const jobSubData: SidebarItem.IData[] = [
    { id: "2a", title: "Active Jobs", onClick: onClick, size: SidebarItem.size.Small, isSubitem: true, counter: "258" },
    { id: "2b", title: "Archived jobs", onClick: onClick, size: SidebarItem.size.Small, isSubitem: true, counter: "1000" },
];

const settingsSubData: SidebarItem.IData[] = [
    { id: "4a", title: "Subitem 1", onClick: onClick, size: SidebarItem.size.Small, isSubitem: true, counter: "11" },
    { id: "4b", title: "Subitem 2", onClick: onClick, size: SidebarItem.size.Small, isSubitem: true, counter: "8" },
    { id: "4c", title: "Subitem 3", onClick: onClick, size: SidebarItem.size.Small, isSubitem: true },
];

const rootData: (SidebarItem.IData | SidebarItemCollapsible.IData)[] = [
    { id: "1", onClick: onClick, title: "Main", iconContent: dataHelper.getIconMain(), isActive: true },
    {
        id: "2",
        onClick: onClick,
        title: "Jobs",
        iconContent: dataHelper.getIconJobs(),
        isCollapsible: true,
        collapsibleContent: dataHelper.getItemsFromData(jobSubData),
    },
    { id: "3", onClick: onClick, title: "Optical Mark Profiles", iconContent: dataHelper.getIconProfiles(), counter: "25" },
    {
        id: "4",
        onClick: onClick,
        title: "Settings",
        iconContent: dataHelper.getIconSettings(),
        isCollapsible: true,
        collapsibleContent: dataHelper.getItemsFromData(settingsSubData),
    },
];

function onClick(item: SidebarItem.IData): boolean {
    if (item.isCollapsible) {
        item.isExpanded = !item.isExpanded;
    } else {
        dataHelper.setActiveItem(getAllData(), item.id);
    }
    b.invalidate();
    return true;
}

function getAllData(): (SidebarItem.IData | SidebarItemCollapsible.IData)[] {
    return rootData.concat(jobSubData).concat(settingsSubData);
}
